
#import <Foundation/Foundation.h>

NSString *StringFromMonkeyData(Byte *data);


//: session_snapchat_other_unread
Byte widgetForestError[] = {3, 29, 53, 8, 255, 201, 67, 70, 168, 154, 168, 168, 158, 164, 163, 148, 168, 163, 150, 165, 152, 157, 150, 169, 148, 164, 169, 157, 154, 167, 148, 170, 163, 167, 154, 150, 153, 231};

//: session_snapchat_self_readed
Byte screenPealText[] = {25, 28, 94, 14, 194, 156, 229, 101, 10, 24, 128, 244, 254, 174, 209, 195, 209, 209, 199, 205, 204, 189, 209, 204, 191, 206, 193, 198, 191, 210, 189, 209, 195, 202, 196, 189, 208, 195, 191, 194, 195, 194, 99};

//: data
Byte k_publishValue[] = {94, 4, 39, 8, 40, 182, 186, 28, 139, 136, 155, 136, 79};

//: session_snapchat_self_unread
Byte layoutCelFormat[] = {9, 28, 23, 5, 90, 138, 124, 138, 138, 128, 134, 133, 118, 138, 133, 120, 135, 122, 127, 120, 139, 118, 138, 124, 131, 125, 118, 140, 133, 137, 124, 120, 123, 121};

//: HEIC
Byte appConnectionMessage[] = {42, 4, 26, 10, 170, 92, 143, 40, 30, 206, 98, 95, 99, 93, 94};

//: jpg
Byte widgetConnectTitle[] = {67, 3, 60, 12, 11, 33, 75, 61, 23, 30, 11, 179, 166, 172, 163, 48};

//: session_snapchat_other_readed
Byte viewSymbolContent[] = {23, 29, 63, 9, 173, 87, 168, 140, 255, 178, 164, 178, 178, 168, 174, 173, 158, 178, 173, 160, 175, 162, 167, 160, 179, 158, 174, 179, 167, 164, 177, 158, 177, 164, 160, 163, 164, 163, 90};

//: url
Byte layoutOperativePage[] = {6, 3, 41, 14, 53, 234, 155, 38, 21, 37, 176, 126, 142, 132, 158, 155, 149, 85};

//: fired
Byte commonDocumentReachName[] = {65, 5, 46, 14, 56, 209, 113, 144, 142, 244, 227, 3, 208, 182, 148, 151, 160, 147, 146, 167};

//: type
Byte commonRetirementValue[] = {3, 4, 65, 6, 66, 173, 181, 186, 177, 166, 53};

//: md5
Byte viewStoryData[] = {74, 3, 79, 11, 91, 87, 83, 105, 230, 131, 76, 188, 179, 132, 65};

// __DEBUG__
// __CLOSE_PRINT__
//
//  SnapchatAttachment.m
//  NIM
//
//  Created by amao on 7/2/15.
//  Copyright (c) 2015 Netease. All rights reserved.
//

// __M_A_C_R_O__
//: #import "AnalyzeMarshVastClass.h"
#import "AnalyzeMarshVastClass.h"
//: #import "LeanApply.h"
#import "LeanApply.h"
//: #import "NSData+SchedulerConfigureToolbar.h"
#import "NSData+SchedulerConfigureToolbar.h"
//: #import "SkillDecorator.h"
#import "SkillDecorator.h"

//: @interface AnalyzeMarshVastClass()
@interface AnalyzeMarshVastClass()

//: @property (nonatomic,assign) BOOL isFromMe;
@property (nonatomic,assign) BOOL groundMe;

//: @end
@end

//: @implementation AnalyzeMarshVastClass
@implementation AnalyzeMarshVastClass

//: - (void)setIsFired:(BOOL)isFired{
- (void)setConstructPainter:(BOOL)isFired{
    //: if (_isFired != isFired) {
    if (_constructPainter != isFired) {
        //: _isFired = isFired;
        _constructPainter = isFired;
        //: [self updateCover];
        [self sphere];
    }
}

//: - (CGSize)contentSize:(NIMMessage *)message cellWidth:(CGFloat)width{
- (CGSize)woman:(NIMMessage *)message exposition:(CGFloat)width{
    //: self.isFromMe = message.isOutgoingMsg;
    self.groundMe = message.isOutgoingMsg;
    //: CGSize size = self.showCoverImage.size;
    CGSize size = self.along.size;
    //: CGFloat customSnapMessageImageRightToText = 5;
    CGFloat customSnapMessageImageRightToText = 5;
    //: return CGSizeMake(size.width + customSnapMessageImageRightToText, size.height);
    return CGSizeMake(size.width + customSnapMessageImageRightToText, size.height);
}

//: - (void)setImage:(UIImage *)image
- (void)setSky:(UIImage *)image
{
    //: NSData *data = UIImageJPEGRepresentation(image, 0.3);
    NSData *data = UIImageJPEGRepresentation(image, 0.3);
    //: NSString *md5= [data MD5String];
    NSString *md5= [data menu];
    //: self.md5 = md5;
    self.thread5 = md5;

    //: [data writeToFile:[self filepath]
    [data writeToFile:[self founder]
           //: atomically:YES];
           atomically:YES];
}


//: - (BOOL)canBeForwarded
- (BOOL)preserve
{
    //: return NO;
    return NO;
}


//: #pragma mark - https
#pragma mark - https
//: - (NSString *)url
- (NSString *)ordinal
{
    //: return [_url length] ?
    return [_ordinal length] ?
    //: [[[NIMSDK sharedSDK] resourceManager] normalizeURLString:_url] : nil;
    [[[NIMSDK sharedSDK] resourceManager] normalizeURLString:_ordinal] : nil;
}

//: - (void)setImageFilePath:(NSString *)path
- (void)setPrimrosePath:(NSString *)path
{
    //: if ([[NSFileManager defaultManager] fileExistsAtPath:path]){
    if ([[NSFileManager defaultManager] fileExistsAtPath:path]){
        //: NSData *jpgData = nil;
        NSData *jpgData = nil;
        //: if ([path.pathExtension.uppercaseString isEqualToString:@"HEIC"]) {
        if ([path.pathExtension.uppercaseString isEqualToString:StringFromMonkeyData(appConnectionMessage)]) {
            //: CIImage *ciImage = [CIImage imageWithContentsOfURL:[NSURL fileURLWithPath:path]];
            CIImage *ciImage = [CIImage imageWithContentsOfURL:[NSURL fileURLWithPath:path]];
                                //: CIContext *context = [CIContext context];
                                CIContext *context = [CIContext context];
            //: jpgData = [context JPEGRepresentationOfImage:ciImage colorSpace:ciImage.colorSpace options:@{}];
            jpgData = [context JPEGRepresentationOfImage:ciImage colorSpace:ciImage.colorSpace options:@{}];
        //: } else {
        } else {
            //: jpgData = [NSData dataWithContentsOfFile:path];
            jpgData = [NSData dataWithContentsOfFile:path];
        }

        //: self.md5 = [jpgData MD5String];
        self.thread5 = [jpgData menu];

        //: [jpgData writeToFile:[self filepath]
        [jpgData writeToFile:[self founder]
               //: atomically:YES];
               atomically:YES];
     }
}

//: #pragma mark - 实现文件上传需要接口
#pragma mark - 实现文件上传需要接口
//: - (BOOL)attachmentNeedsUpload
- (BOOL)attachmentNeedsUpload
{
    //: return [_url length] == 0;
    return [_ordinal length] == 0;
}

//: - (NSString *)cellContent:(NIMMessage *)message{
- (NSString *)jungle:(NIMMessage *)message{
    //: self.isFromMe = message.isOutgoingMsg;
    self.groundMe = message.isOutgoingMsg;
    //: return @"ReleaseRunWood";
    return @"ReleaseRunWood";
}

//: - (BOOL)canBeRevoked
- (BOOL)assign
{
    //: return YES;
    return YES;
}

//: - (UIImage *)showCoverImage
- (UIImage *)along
{
    //: if (_showCoverImage == nil)
    if (_along == nil)
    {
        //: [self updateCover];
        [self sphere];
    }
    //: return _showCoverImage;
    return _along;
}



//: - (UIEdgeInsets)contentViewInsets:(NIMMessage *)message
- (UIEdgeInsets)stereoscopicPhotographClose:(NIMMessage *)message
{
    //: CGFloat bubblePaddingForImage = 3.f;
    CGFloat bubblePaddingForImage = 3.f;
    //: CGFloat bubbleArrowWidthForImage = -4.f;
    CGFloat bubbleArrowWidthForImage = -4.f;
    //: if (message.isOutgoingMsg) {
    if (message.isOutgoingMsg) {
        //: return UIEdgeInsetsMake(bubblePaddingForImage,bubblePaddingForImage,bubblePaddingForImage,bubblePaddingForImage + bubbleArrowWidthForImage);
        return UIEdgeInsetsMake(bubblePaddingForImage,bubblePaddingForImage,bubblePaddingForImage,bubblePaddingForImage + bubbleArrowWidthForImage);
    //: } else {
    } else {
        //: return UIEdgeInsetsMake(bubblePaddingForImage,bubblePaddingForImage + bubbleArrowWidthForImage + 4, bubblePaddingForImage,bubblePaddingForImage);
        return UIEdgeInsetsMake(bubblePaddingForImage,bubblePaddingForImage + bubbleArrowWidthForImage + 4, bubblePaddingForImage,bubblePaddingForImage);
    }
}


//: #pragma NIMCustomAttachment
#pragma NIMCustomAttachment
//: - (NSString *)encodeAttachment
- (NSString *)encodeAttachment
{
    //: NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    NSMutableDictionary *dict = [NSMutableDictionary dictionary];
    //: NSMutableDictionary *data = [NSMutableDictionary dictionary];
    NSMutableDictionary *data = [NSMutableDictionary dictionary];
    //: [dict setObject:@(ProjectorWoodYieldTypeSnapchat) forKey:@"type"];
    [dict setObject:@(ProjectorWoodYieldTypeSnapchat) forKey:StringFromMonkeyData(commonRetirementValue)];
    //: [data setObject:_md5?_md5:@"" forKey:@"md5"];
    [data setObject:_thread5?_thread5:@"" forKey:StringFromMonkeyData(viewStoryData)];
    //: [data setObject:@(_isFired) forKey:@"fired"];
    [data setObject:@(_constructPainter) forKey:StringFromMonkeyData(commonDocumentReachName)];
    //: if ([_url length])
    if ([_ordinal length])
    {
        //: [data setObject:_url forKey:@"url"];
        [data setObject:_ordinal forKey:StringFromMonkeyData(layoutOperativePage)];
    }
    //: [dict setObject:data forKey:@"data"];
    [dict setObject:data forKey:StringFromMonkeyData(k_publishValue)];

    //: NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dict
    NSData *jsonData = [NSJSONSerialization dataWithJSONObject:dict
                                                   //: options:0
                                                   options:0
                                                     //: error:nil];
                                                     error:nil];

    //: return [[NSString alloc] initWithData:jsonData
    return [[NSString alloc] initWithData:jsonData
                                 //: encoding:NSUTF8StringEncoding];
                                 encoding:NSUTF8StringEncoding];
}

//: - (void)setIsFromMe:(BOOL)isFromMe{
- (void)setGroundMe:(BOOL)isFromMe{
    //: if (_isFromMe != isFromMe) {
    if (_groundMe != isFromMe) {
        //: _isFromMe = isFromMe;
        _groundMe = isFromMe;
        //: [self updateCover];
        [self sphere];
    }
}

//: - (void)updateAttachmentURL:(NSString *)urlString
- (void)updateAttachmentURL:(NSString *)urlString
{
    //: self.url = urlString;
    self.ordinal = urlString;
}


//: - (NSString *)attachmentPathForUploading
- (NSString *)attachmentPathForUploading
{
    //: return [self filepath];
    return [self founder];
}

//: - (NSString *)filepath
- (NSString *)founder
{
    //: NSString *filename = [_md5 stringByAppendingFormat:@".%@",(@"jpg")];
    NSString *filename = [_thread5 stringByAppendingFormat:@".%@",(StringFromMonkeyData(widgetConnectTitle))];
    //: return [LeanApply filepathForImage:filename];
    return [LeanApply rendering:filename];
}

//: #pragma mark - Private
#pragma mark - Private
//: - (void)updateCover{
- (void)sphere{
    //: UIImage *image;
    UIImage *image;
    //: if (!self.isFromMe) {
    if (!self.groundMe) {
        //: if (self.isFired) {
        if (self.constructPainter) {
            //: image = [UIImage imageNamed:@"session_snapchat_other_readed"];
            image = [UIImage imageNamed:StringFromMonkeyData(viewSymbolContent)];
        //: }else{
        }else{
            //: image = [UIImage imageNamed:@"session_snapchat_other_unread"];
            image = [UIImage imageNamed:StringFromMonkeyData(widgetForestError)];
        }
    //: }else{
    }else{
        //: if (self.isFired) {
        if (self.constructPainter) {
            //: image = [UIImage imageNamed:@"session_snapchat_self_readed"];
            image = [UIImage imageNamed:StringFromMonkeyData(screenPealText)];
        //: }else{
        }else{
            //: image = [UIImage imageNamed:@"session_snapchat_self_unread"];
            image = [UIImage imageNamed:StringFromMonkeyData(layoutCelFormat)];
        }
    }
    //: self.showCoverImage = image;
    self.along = image;
}

//: @end
@end

Byte * MonkeyDataToCache(Byte *data) {
    int effectiveCalm = data[0];
    int societyReading = data[1];
    Byte listControl = data[2];
    int dataConverter = data[3];
    if (!effectiveCalm) return data + dataConverter;
    for (int i = dataConverter; i < dataConverter + societyReading; i++) {
        int value = data[i] - listControl;
        if (value < 0) {
            value += 256;
        }
        data[i] = value;
    }
    data[0] = 0;
    data[dataConverter + societyReading] = 0;
    return data + dataConverter;
}

NSString *StringFromMonkeyData(Byte *data) {
    return [NSString stringWithUTF8String:(char *)MonkeyDataToCache(data)];
}
